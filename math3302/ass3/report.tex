\documentclass{article}
\usepackage{mathtools}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{graphicx}
\usepackage{float}
\usepackage{verbatim}

\linespread{1.3}
\setlength{\parindent}{0em}
\setlength{\parskip}{1em}
\setcounter{secnumdepth}{0}
\setcounter{MaxMatrixCols}{20}

\title{Assignment 3}
\author{Joshua Hwang (44302650)}
\date{5 May}

\begin{document}
\maketitle

\section{Hill cipher}
\subsection{Find inverse}
We attempt to find $K^{-1}$ through the standard form of the $2\times2$
matrix. ZZZ - we must prove why this works in our ring.
\begin{align*}
    (ad-bc)^{-1}
    \begin{bmatrix}
        d & -b \\
        -c & a
    \end{bmatrix}
    &=
    (15-8)^{-1}
    \begin{bmatrix}
        5 & -2 \\
        -4 & 3
    \end{bmatrix}
\end{align*}

It simply requires us to find $7^{-1}$ in $\mathbb{Z}_{26}$ (which exists since
they are coprime).

By using the extended Euler algorithm we can find this inverse.
\begin{align*}
    26 &= 7\times3 + 5 \\
    7 &= 5\times1 + 2 \\
    5 &= 2\times2 + 1 && \text{The GCF is 1} \\
    1 &= 5 - 2\times2 \\
    1 &= 5 - 2(7-5) \\
    1 &= 3\times5 - 2\times7 \\
    1 &= 3(26 - 7\times3) - 2\times7 \\
    1 &= 3\times26 - 7\times11 \\
\end{align*}

Thus $7^{-1} = -11 = 15$ in $\mathbb{Z}_{26}$. Our inverse matrix is thus,
\begin{align*}
    15
    \begin{bmatrix}
        5 & -2 \\
        -4 & 3
    \end{bmatrix}
    &=
    \begin{bmatrix}
        23 & 22 \\
        18 & 19
    \end{bmatrix}
\end{align*}

\subsection{Recover plaintext}
Using the matrix above and the vectors produced by this message,
\begin{verbatim}
WOPSBOEALHMU
\end{verbatim}
\begin{align*}
    \begin{pmatrix}
        22 \\ 14
    \end{pmatrix} \\
    \begin{pmatrix}
        15 \\ 18
    \end{pmatrix} \\
    \begin{pmatrix}
        1 \\ 14
    \end{pmatrix} \\
    \begin{pmatrix}
        4 \\ 0
    \end{pmatrix} \\
    \begin{pmatrix}
        11 \\ 7
    \end{pmatrix} \\
    \begin{pmatrix}
        12 \\ 20
    \end{pmatrix} \\
\end{align*}

We then decrypt using $K^{-1}x$ where $x$ will be each of the vectors above.
\begin{align*}
    \begin{bmatrix}
        23 & 22 \\
        18 & 19
    \end{bmatrix}
    \begin{pmatrix}
        22 \\ 14
    \end{pmatrix}
    &= 
    \begin{pmatrix}
        23\times22 + 22\times14 \\
        18\times22 + 19\times14 \\
    \end{pmatrix} \\
    &=
    \begin{pmatrix}
        8 \\
        12 \\
    \end{pmatrix} \\
\end{align*}

We repeat this process for each vector and get the following result.
\begin{verbatim}
imnotyourtoy
\end{verbatim}

\section{Unique ciphers}
\subsection{Shift cipher}
\begin{verbatim}
UJGCXIJGT
\end{verbatim}

I use a Python program to exhaust all possibilities.
\verbatiminput{q2a.py}

The most satisfactory result was \texttt{furniture} with shift 15.

\subsection{Affine cipher}
\begin{verbatim}
BWXHNHQCDXNWEFZTHJHBUNWWSRMHEWP
\end{verbatim}

Since we know \texttt{it} maps to \texttt{BW} in our message we can produce
a set of simulataneous equations. (\texttt{i=8, t=19, b=1, w=22})
\begin{align*}
    \begin{cases}
        8a + b &= 1 \bmod 26 \\
        19a + b &= 22 \bmod 26 \\
    \end{cases} \\
    \begin{cases}
        b &= 1 - 8a \bmod 26 \\
        b &= 22 - 19a \bmod 26 \\
    \end{cases} \\
    1 - 8a &= 22 - 19a \bmod 26 \\
    11a &= 21 \bmod 26 \\
    a &= 21(11^{-1}) \bmod 26 \\
\end{align*}

We find $11^{-1}$ in $\mathbb{Z}_{26}$. From the previous question we already
know,
\begin{align*}
    1 &= 3\times26 - 7\times11 \\
\end{align*}

So $a = 9 \bmod 26$. Now we must find $a^{-1}$.
\begin{align*}
    26 &= 2\times9 + 8 \\
    9 &= 8 + 1 && \text{The GCF is 1} \\
    1 &= 9 - 8 \\
    1 &= 9 - (26 - 2\times9) \\
    1 &= -26 + 3\times9 \\
\end{align*}

Thus $a^{-1} = 3$.

Now we find $b$.
\begin{align*}
    8a + b &= 1 \bmod 26 \\
    8(9) + b &= 1 \bmod 26 \\
    20 + b &= 1 \bmod 26 \\
    b &= 7 \bmod 26 \\
\end{align*}

With these we may now decode the text. Another Python progam was written to do
this job.
\begin{verbatim}
msg = "bwxhnhqcdxnwefzthjhbunwwsrmhewp"
ans=""
# iterate over each character in the message
for c in msg:
  i = ord(c) - ord('a')
  # use the decoding algorithm for affine ciphers
  i_d = (3*(i-7) + 26)%26
  c_d = chr(i_d + ord('a'))
  ans += c_d

print(ans)
\end{verbatim}

The end result is \texttt{itwasablowstruckagainsttheparty}.

\subsection{Vigenere cipher}
\begin{verbatim}
LAOGINXBVRYTHRMYAHGLAKHLIPJIVWAMSYCVKSFWWWOAHOXOEM
FZOYEJZSOYLMCALGESBJHTFZENBCYILLRBVATBTVSRKNWMLVRV
WWWAXGEOQCFTFOSJHITLKWFNAAGUESGFPLFGPWAKKXFIEFMGUM
KYCEIZXOQASLHUVGUPVRYPWGLETRQIFXRAIJOSFEFWVRJWEHJM
DWZLIPVWGIVUIGLALANRFXFNWZXPRRLHJRVZBGUSKMSFWKAOAH
OTGNWWTGLEFWUEEUXTHPSLSIIJISELSIGBRWGSIIJLSRQKLCZY
UAOGSFXGREKXOFAZXBBRWAOFXGIZNCSIOEXUXFGEAGZLRGHBRP
GHYVRYTHQSJBOAKJTMGLSMBVKZMQBYDWVNZWUSYMWOSQXZTHUI
ZTRCEKLSQXZKCHKZTHEEYXRLEKACEVAUZREKTBLXJTURHQHTBY
JTURXZHGRJAGSYCKAOCIVYWAKWKGPSMERAINXFUENXQYYLVVRH
SDBVJWYCEWAGBBVLACFIKFWYMFZZVTKAOIIUKWRHGNHBRYHRNR
VZCBHFXGFLWAWZWWETPSMERASLASYTOHBQIJBBTELMVRGSEABJ
ZBGQIEXOASMKOAHXHFNQGFSAXXXZGOWXBYCLASGIJKWOPWIZRE
KNFRSXTRBYTESYMXXWGASLOFQSEZCEJMMTSLNDEELASEMFTVHV
JRPLPSWMAEJUCESMZVJLGPOFENXFLGDXJRVOHANROBHUAZTHYS
JWVRRJRIFIVMCQIKVFVFWTGGLWKSZEAGGBJJXOYPQKSZEJDOOP
WNUYMFXGFWZXVNHHKCIIVTBRBUXZYIFMKVJWMCBRWHTBYJFCFX
LXRVSMLOZFSLGNHGKGNRVAOIMFZPHVAXRUIJAIFFSGRCVGISEP
QBBNQSKPYIETIFSDXIZAZBQUWZXVNHZXFFIDYRRWAZBRHSGRZE
JKWRHGYTUIJWOHKZMSEWLHGBQWKWPLJTHUIJXZQIJEMZIFLVRH
WOCGIVASEWWETASOMCGLWIZREKNFRWGYTEIFVVSMUMWBRXKSAG
ZVCBOWKM
\end{verbatim}

Kasiski's test was completed with a Python program.
\verbatiminput{q2c.py}

We know employ Friedman's first method.
ZZZ - explicitly run through each m
We now check the index of coincidence from the helpful table provided in
my text file. For $m=5$ we get 0.065, 0.065, 0.064, 0.061 and 0.065. This
fits very well with the English language index of 0.065.

Friedman's second method is given by,
\begin{align*}
    m &\approx \frac{n(I_l - I_0)}{(n-1)I_T - nI_0 + I_l}
    &= \frac{n(I_l - I_0)}{(n-1)I_T - nI_0 + I_l}
\end{align*}

If we were to use all distances, we would be grabbing some distances which
aren't valuable.

\end{document}
